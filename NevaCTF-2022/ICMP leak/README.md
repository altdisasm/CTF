# ICMP leak

На входе у нас есть [дамп трафика](/NevaCTF-2022/ICMP%20leak/files/ICMP_leak.pcap) в формате `.pcap`. Из названия понятно, что стоит обратить внимание на части трафика, которые относятся к протоколу `ICMP`.

Можно увидеть множество `ICMP echo` запросов, нужно обратить внимание на то, что они имеют аномально большой размер - 1450 байт.

Заглянув в первый пакет, можно увидеть в полезной нагрузке сигнатуру `PNG` файла.

![ICMP in pcap](/NevaCTF-2022/ICMP%20leak/img/icmp.PNG)

Собрав правильно все байты следующих друг за другом, больших пакетов, получаем следующую картинку.

![Part 1](/NevaCTF-2022/ICMP%20leak/img/part1.PNG)

Это QR код, у которого вырезаны некоторые части. Для получения полного QR кода можно либо дорисовать эту часть, либо достать вторую из дампа трафика и наложить части друг на друга.

Ссылка из QR кода ведет к текстовому файлу, содержимое которого закодировано `Base64`, до этого можно догадаться по символу `=` в конце.

Раскодированное содержимое представляет собой `xml` код `svg` файла. Если сохранить файл в указннам формате и открыть в браузере, можно будет увидеть дорогу, в белых элементах которых переодически мелькают какие-то фрагменты. Если посмотреть код, внем можно уидеть фрагменты флага.

![ROAD](/NevaCTF-2022/ICMP%20leak/img/road.PNG)

Раз у на есть код - можно в нем разобраться и отрадактировать. Ну или просто попробовать собрать флаг из фрагментов внутри него.

Если удалить дорогу и убрать у всех элементов флага зацикливание получится вот так.

![ROAD](/NevaCTF-2022/ICMP%20leak/img/final.PNG)

## Well done!!!
